import { db } from './src/db/index.js'; import { products, retailerListings } from './src/db/schema.js'; import { like, eq, or } from 'drizzle-orm'; const badProducts = await db.select().from(products).where(or(like(products.name, '%[%'), like(products.name, '%]%'), like(products.name, '%http%'))); console.log('Found bad products:', badProducts.length); for (const p of badProducts) { await db.delete(retailerListings).where(eq(retailerListings.productId, p.id)); await db.delete(products).where(eq(products.id, p.id)); console.log('Deleted:', p.name.substring(0, 60)); } process.exit(0);
